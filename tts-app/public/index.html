<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Claude Code Hooks Manager</title>
  <link rel="icon" type="image/png" sizes="64x64" href="/favicon.png">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header>
    <h1>Claude Code Hooks Manager</h1>
    <p class="subtitle">Configuration & TTS Testing</p>
  </header>

  <nav class="tabs" role="tablist">
    <button class="tab active" data-panel="providers" role="tab" aria-selected="true">Providers</button>
    <button class="tab" data-panel="templates" role="tab" aria-selected="false">Templates</button>
    <button class="tab" data-panel="test" role="tab" aria-selected="false">Test Harness</button>
    <button class="tab" data-panel="settings" role="tab" aria-selected="false">Settings</button>
    <button class="tab" data-panel="security" role="tab" aria-selected="false">Security</button>
    <span class="status" id="status">Loading...</span>
  </nav>

  <main>
    <!-- Panel 1: TTS Providers -->
    <section id="panel-providers" class="panel active" role="tabpanel">
      <h2>TTS Providers</h2>
      <p class="panel-desc">Drag to reorder priority. Click a row to configure API keys and settings.</p>

      <div class="provider-list" id="provider-list"></div>
    </section>

    <!-- Panel 2: Templates -->
    <section id="panel-templates" class="panel" role="tabpanel">
      <h2>Templates</h2>
      <p class="panel-desc">Edit TTS message templates for each hook type.</p>

      <div class="form-group" style="margin-bottom: 1rem; max-width: 240px;">
        <label for="template-tone">Template Tone</label>
        <select id="template-tone"></select>
      </div>

      <div class="template-tabs" id="template-tabs">
        <button class="template-tab active" data-hook="stop">Stop</button>
        <button class="template-tab" data-hook="subagentStop">SubagentStop</button>
        <button class="template-tab" data-hook="notification">Notification</button>
        <button class="template-tab" data-hook="sessionEnd">SessionEnd</button>
      </div>

      <div class="template-variables">
        <strong>Available Variables:</strong>
        <span class="var-chip" data-var="projectName" title="Current project name">{{projectName}}</span>
        <span class="var-chip" data-var="userName" title="User name from USER_NAME env">{{userName}}</span>
        <span class="var-chip" data-var="activity" title="Last activity description">{{activity}}</span>
        <span class="var-chip" data-var="lastActivity" title="Most recent activity">{{lastActivity}}</span>
        <span class="var-chip" data-var="count" title="Number of activities">{{count}}</span>
        <span class="var-chip" data-var="agentName" title="Subagent friendly name">{{agentName}}</span>
        <span class="var-chip" data-var="description" title="Subagent task description">{{description}}</span>
      </div>

      <div id="template-editor"></div>

      <div class="template-actions">
        <button id="btn-save-templates" class="btn btn-primary">Save Templates</button>
        <button id="btn-reset-templates" class="btn btn-secondary">Reset to Defaults</button>
      </div>
    </section>

    <!-- Panel 3: TTS Test Harness -->
    <section id="panel-test" class="panel" role="tabpanel">
      <h2>TTS Test Harness</h2>
      <p class="panel-desc">Test TTS output with different providers and messages.</p>

      <div class="test-controls">
        <div class="form-group">
          <label for="test-text">Text to speak:</label>
          <textarea id="test-text" rows="3" placeholder="Type a message to speak..."></textarea>
        </div>

        <div class="form-group">
          <label for="test-provider">Provider:</label>
          <select id="test-provider">
            <option value="">Auto (use priority)</option>
          </select>
        </div>

        <button id="btn-speak" class="btn btn-primary">Speak</button>
        <span id="test-result" class="test-result"></span>
      </div>

      <h3>Quick Tests</h3>
      <div class="quick-tests" id="quick-tests">
        <button class="btn btn-sm" data-text="CLI v1: Done. I updated the configuration file.">Stop (with activity)</button>
        <button class="btn btn-sm" data-text="CLI v1: Ready for the next task.">Stop (no activity)</button>
        <button class="btn btn-sm" data-text="CLI v1: Explorer finished searching the codebase.">SubagentStop</button>
        <button class="btn btn-sm" data-text="CLI v1: Your agent needs your input.">Notification</button>
        <button class="btn btn-sm" data-text="CLI v1: Session ended.">Session End</button>
      </div>
    </section>

    <!-- Panel 4: Settings -->
    <section id="panel-settings" class="panel" role="tabpanel">
      <h2>Settings</h2>

      <div class="settings-section">
        <h3>Global TTS</h3>
        <label class="toggle-row">
          <input type="checkbox" id="tts-enabled" checked>
          <span>TTS Enabled (global on/off)</span>
        </label>
      </div>

      <div class="settings-section">
        <h3>Name Include Probability</h3>
        <p class="panel-desc">How often your name is included in TTS messages (0 = never, 1 = always).</p>
        <div class="form-group">
          <label>Probability: <span id="nameProb-val"></span></label>
          <input type="range" id="nameIncludeProbability" min="0" max="1" step="0.05">
        </div>
      </div>

      <div class="settings-section">
        <h3>Per-Hook TTS Toggles</h3>
        <label class="toggle-row">
          <input type="checkbox" id="toggle-stop" checked>
          <span>Stop hook</span>
        </label>
        <label class="toggle-row">
          <input type="checkbox" id="toggle-subagentStop" checked>
          <span>SubagentStop hook</span>
        </label>
        <label class="toggle-row">
          <input type="checkbox" id="toggle-notification" checked>
          <span>Notification hook</span>
        </label>
        <label class="toggle-row">
          <input type="checkbox" id="toggle-sessionEnd" checked>
          <span>SessionEnd hook</span>
        </label>
      </div>

      <div class="settings-section">
        <h3>Summarization</h3>
        <label class="toggle-row">
          <input type="checkbox" id="summarization-enabled" checked>
          <span>Summarization Enabled</span>
        </label>

        <div class="settings-grid" style="margin-top: 0.75rem;">
          <div class="form-group">
            <label>Max Words</label>
            <input type="number" id="summarization-maxWords" min="5" max="100">
          </div>
          <div class="form-group">
            <label>Style</label>
            <select id="summarization-style">
              <option value="concise">Concise</option>
              <option value="detailed">Detailed</option>
              <option value="technical">Technical</option>
              <option value="casual">Casual</option>
              <option value="bullet-points">Bullet Points</option>
              <option value="narrative">Narrative</option>
            </select>
          </div>
        </div>

        <h4 class="llm-subheading">LLM Models</h4>
        <p class="panel-desc" style="margin-bottom: 0.75rem;">These models are used for summarization only.</p>
        <div class="llm-row">
          <div class="form-group">
            <label>Anthropic Model</label>
            <input type="text" id="llm-anthropic-model" placeholder="claude-haiku-4-5-20251001">
          </div>
          <div class="form-group">
            <label>Anthropic Max Tokens</label>
            <input type="number" id="llm-anthropic-maxTokens" min="1" max="4096">
          </div>
          <div class="form-group">
            <label>Anthropic Temperature</label>
            <input type="number" id="llm-anthropic-temperature" min="0" max="1" step="0.1">
          </div>
        </div>
        <div class="llm-row">
          <div class="form-group">
            <label>OpenAI Model</label>
            <input type="text" id="llm-openai-model" placeholder="gpt-4o-mini">
          </div>
          <div class="form-group">
            <label>OpenAI Max Tokens</label>
            <input type="number" id="llm-openai-maxTokens" min="1" max="4096">
          </div>
          <div class="form-group">
            <label>OpenAI Temperature</label>
            <input type="number" id="llm-openai-temperature" min="0" max="1" step="0.1">
          </div>
        </div>
      </div>

      <div class="settings-section">
        <h3>Queue</h3>
        <label class="toggle-row">
          <input type="checkbox" id="queue-enabled">
          <span>Queue Enabled</span>
        </label>
        <div class="form-group">
          <label>Max Wait (ms): <span id="queue-maxWaitMs-val"></span></label>
          <input type="range" id="queue-maxWaitMs" min="5000" max="120000" step="1000">
        </div>
      </div>

      <div class="settings-section">
        <h3>Guardrails</h3>
        <label class="toggle-row">
          <input type="checkbox" id="guardrails-enabled">
          <span>Guardrails Enabled (global)</span>
        </label>

        <h4>Sleep Guard</h4>
        <label class="toggle-row">
          <input type="checkbox" id="guardrails-sleep-enabled">
          <span>Sleep Guard Enabled</span>
        </label>
        <div class="form-group">
          <label>Max Seconds</label>
          <input type="number" id="guardrails-sleep-maxSeconds" min="10" max="600">
        </div>

        <h4>Subagent Repeat Guard</h4>
        <label class="toggle-row">
          <input type="checkbox" id="guardrails-subagentRepeat-enabled">
          <span>Subagent Repeat Guard Enabled</span>
        </label>
        <div class="form-group">
          <label>Max Launches</label>
          <input type="number" id="guardrails-subagentRepeat-maxLaunches" min="1" max="20">
        </div>
      </div>

      <div class="settings-actions">
        <button id="btn-save-settings" class="btn btn-primary">Save Settings</button>
        <button id="btn-reset-settings" class="btn btn-secondary">Reset to Defaults</button>
      </div>
    </section>

    <!-- Panel 5: Security (read-only) -->
    <section id="panel-security" class="panel" role="tabpanel">
      <h2>Security (Read-Only)</h2>
      <p class="panel-desc">Security rules are displayed here for reference. Edit them manually in hooks.config.json.</p>

      <div class="security-section">
        <h3>Dangerous Patterns</h3>
        <pre id="security-dangerousPatterns"></pre>
      </div>

      <div class="security-section">
        <h3>Protected Paths</h3>
        <pre id="security-protectedPaths"></pre>
      </div>

      <div class="security-section">
        <h3>Allowed Paths</h3>
        <pre id="security-allowedPaths"></pre>
      </div>

      <div class="security-section">
        <h3>Denied File Patterns</h3>
        <pre id="security-deniedFilePatterns"></pre>
      </div>
    </section>
  </main>

  <script src="app.js"></script>
</body>
</html>
